class s{constructor(){if(globalThis.__ficusjs__&&globalThis.__ficusjs__.eventBus)return globalThis.__ficusjs__.eventBus;this.subscribers={},globalThis.__ficusjs__=globalThis.__ficusjs__||{},globalThis.__ficusjs__.eventBus=globalThis.__ficusjs__.eventBus||this}getSubscribers(s){return s?this.subscribers[s]:this.subscribers}subscribe(s,e,t={}){const i=this,u=Object.assign({callCount:0,fireOnce:!1},t);i.subscribers[s]||(i.subscribers[s]=new Map);return i.subscribers[s].set(e,u),()=>{const t=new Map;i.subscribers[s].forEach(((s,i)=>i!==e&&t.set(i,s))),i.subscribers[s]=t}}publish(s,e){if(!this.subscribers[s])return[];const t=new Map;return this.subscribers[s].forEach(((s,i)=>{s.fireOnce&&1===s.callCount||(i(e),++s.callCount,t.set(i,s))})),t}}function createEventBus(){return new s}function getEventBus(){return createEventBus()}function withEventBus(s,e){return Object.assign(Object.assign({},e),{created(){this.setEventBus(s),e.created&&e.created.call(this)},mounted(){this._subscribeToEventBus(),e.mounted&&e.mounted.call(this)},updated(){this._subscribeToEventBus(),e.updated&&e.updated.call(this)},removed(){this._unsubscribeFromEventBus(),e.removed&&e.removed.call(this)},setEventBus(s){const e=this;e._eventBus=s,e._eventSubscriptions={},e.eventBus={subscribe:(s,t,i)=>(e._eventSubscriptions[s]={unsubscribe:e._eventBus.subscribe(s,t,i),callback:t,options:i},function(){const{unsubscribe:t}=e._eventSubscriptions[s];t&&t(),e._eventSubscriptions[s].unsubscribe=null}),publish(s,t={}){e._eventBus.publish(s,t)},getSubscribers:s=>e._eventBus.getSubscribers(s)}},_subscribeToEventBus(){for(const s in this._eventSubscriptions){const{unsubscribe:e,callback:t,options:i}=this._eventSubscriptions[s];e||(this._eventSubscriptions[s].unsubscribe=this._eventBus.subscribe(s,t,i))}},_unsubscribeFromEventBus(){for(const s in this._eventSubscriptions){const{unsubscribe:e}=this._eventSubscriptions[s];e&&e(),this._eventSubscriptions[s].unsubscribe=null}}})}export{createEventBus,getEventBus,withEventBus};
//# sourceMappingURL=index.mjs.map
